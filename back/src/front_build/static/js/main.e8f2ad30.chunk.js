(this["webpackJsonpred-tetris-front"]=this["webpackJsonpred-tetris-front"]||[]).push([[0],{33:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(29),i=n.n(r),o=(n(48),n(37)),s=n(3),l=n(24),d=(n(49),n(27)),j=n(1),u=function(e){var t=e.children,n=e.onClick;return Object(j.jsx)("button",{className:"block button",onClick:n,children:t})},m=(n(33),function(e){var t=e.value,n=e.onChange,c=e.placeholder;return Object(j.jsx)("input",{className:"block input",type:"text",value:t,placeholder:c,onChange:function(e){n&&n(e.target.value)}})}),b=function(e){var t=e.children,n=e.ellipsis,c=[e.className,"text"];return n&&c.push("ellipsis"),Object(j.jsx)("p",{className:c.join(" "),children:t})},h=function(e){var t=e.justify,n=void 0===t?"between":t,c=e.direction,a=void 0===c?"row":c,r=e.children,i=e.alignItems,o=void 0===i?"stretch":i,s=e.className,l=e.withoutGap,d=[s];switch(d.push("column"===a?"flex-column":"flex-row"),o){case"center":d.push("flex-align-center");break;case"start":d.push("flex-align-start");break;case"stretch":d.push("flex-align-stretch")}switch(n){case"center":d.push("flex-justify-center");break;case"start":d.push("flex-justify-start");break;case"between":d.push("flex-justify-between")}return l||d.push("flex-gap"),Object(j.jsx)("div",{className:d.join(" "),children:r})},x=function(e){var t=e.store,n=Object(c.useState)(""),r=Object(d.a)(n,2),i=r[0],o=r[1];return Object(j.jsx)(a.a.Fragment,{children:Object(j.jsxs)(h,{direction:"column",children:[Object(j.jsx)(b,{children:"Enter your name"}),Object(j.jsx)(m,{placeholder:"Nagibator_9000",value:i,onChange:o}),Object(j.jsx)(u,{onClick:function(){t&&i&&t.login({username:i})},children:"LOGIN"})]})})},O=(n(51),function(e){var t=e.players,n=void 0===t?[]:t,c=e.isFull,a=e.isStarted,r=e.onClick,i=["room"];return(c||a)&&i.push("unavailable"),Object(j.jsx)("div",{className:i.join(" "),onClick:r,children:Object(j.jsxs)(h,{direction:"column",alignItems:"start",children:[Object.values(n).map((function(e){return Object(j.jsx)("div",{children:e.username},e.id)})),c&&Object(j.jsx)("div",{className:"warning",children:"This room is already full"}),a&&Object(j.jsx)("div",{className:"warning",children:"this room is already playing"})]})})}),f=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),c=1;c<t;c++)n[c-1]=arguments[c];return e.bind.apply(e,[null].concat(n))},g=(n(52),Object(l.a)((function(e){var t=e.store;Object(c.useEffect)((function(){t.getRooms()}),[t]);var n=function(e){t.joinRoom({id:e})};return Object(j.jsx)("div",{className:"lobby",children:Object(j.jsxs)(h,{direction:"column",children:[Object(j.jsxs)(b,{children:["Hello, ",t.username]}),Object(j.jsx)(b,{children:"Choose room or create your own one"}),Object(j.jsx)(h,{className:"roomsList",direction:"column",justify:"start",children:t.rooms&&t.rooms.map((function(e){return Object(j.jsx)(O,{players:Object.values(e.players),isFull:e.isFull,isStarted:e.isActive,onClick:e.isFull||e.isStarted?null:f(n,e.id)},e.id)}))}),Object(j.jsx)(u,{onClick:function(){t.createRoom()},children:"Create room"})]})})}))),v=(n(54),[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]]),p=function(e){var t=e.gamedata,n=void 0===t?v:t,c=e.losed,r=e.wined;return Object(j.jsx)(a.a.Fragment,{children:Object(j.jsxs)("div",{className:"container","data-testid":"game",children:[Object(j.jsx)("div",{className:"content"}),Object(j.jsx)("div",{className:"grid",children:n.map((function(e,t){return e.map((function(e,n){var c=0===e?"box":"filled-box";return Object(j.jsx)("div",{className:c},"cell".concat(t,"*").concat(n))}))}))}),c&&Object(j.jsx)("div",{className:"verdict losed",children:"LOSE"}),r&&Object(j.jsx)("div",{className:"verdict wined",children:"WIN"})]})})},w=(n(55),function(e){var t=e.checked,n=e.onClick;return Object(j.jsx)("div",{className:"checkboxWrapper",onClick:n,"data-testid":"checkbox",children:t&&Object(j.jsx)("div",{className:"checkbox","data-testid":"checkbox-checked"})})}),k=Object(l.a)((function(e){var t=e.store,n=Object(c.useState)(!1),a=Object(d.a)(n,2),r=a[0],i=a[1],o=t.gamedata?t.gamedata[t.id]:void 0,s=t.gamedata?Object.entries(t.gamedata).map((function(e){var n=Object(d.a)(e,2),c=n[0],a=n[1];return c===t.id?null:Object(j.jsxs)(h,{direction:"column",children:[Object(j.jsxs)(h,{direction:"row",alignItems:"center",children:[Object(j.jsx)(b,{className:"otherTitle",ellipsis:!0,children:a.username}),Object(j.jsx)(b,{className:"score otherTitle",children:a.score})]}),Object(j.jsx)(p,{gamedata:a.gamedata,losed:a.losed,wined:a.wined})]},"game-".concat(c))})).filter(Boolean):[];Object(c.useEffect)((function(){var e=function(e){if(t.gamedata&&t.gamedata[t.id]&&!t.gamedata[t.id].losed&&!t.gamedata[t.id].wined&&t.gamedata[t.id].isActive)switch(e.code){case"ArrowLeft":t.gameAction({type:"left"});break;case"ArrowRight":t.gameAction({type:"right"});break;case"ArrowUp":t.gameAction({type:"rotate"});break;case"ArrowDown":t.gameAction({type:"drop"});break;case"Space":t.gameAction({type:"forward"})}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[t]);var l=t.currentRoom===t.id,m=o&&o.isActive,x=t.gamedata&&1===Object.values(t.gamedata).length,O=o&&o.wined,f=o&&o.losed,g=t.gamedata&&t.gamedata[t.currentRoom]&&t.gamedata[t.currentRoom].username||"UNKNOWN";return Object(j.jsx)("div",{children:Object(j.jsxs)(h,{direction:"column",children:[Object(j.jsxs)(h,{direction:"row",alignItems:"center",children:[Object(j.jsx)(u,{onClick:function(){t.leaveRoom()},children:"Exit"}),Object(j.jsxs)(b,{children:[g,"'s room"]})]}),Object(j.jsxs)(h,{direction:"row",children:[s.length?Object(j.jsx)(h,{direction:"column",className:"otherGame",justify:"start",children:s}):null,Object(j.jsxs)(h,{direction:"column",className:"mainGame",children:[Object(j.jsxs)(h,{direction:"row",alignItems:"center",children:[Object(j.jsx)(b,{ellipsis:!0,children:o&&o.username}),Object(j.jsxs)(b,{className:"score",children:[" ",o&&o.score]})]}),Object(j.jsx)(p,{gamedata:o&&o.gamedata,losed:f,wined:O}),l&&!m&&Object(j.jsxs)(c.Fragment,{children:[!x&&Object(j.jsxs)(c.Fragment,{children:[Object(j.jsxs)(h,{direction:"row",alignItems:"center",justify:"start",children:[Object(j.jsx)(w,{onClick:function(){i(!r)},checked:r}),Object(j.jsx)(b,{children:"With penalty rows"})]}),Object(j.jsx)(u,{onClick:function(){t.startGame({infMode:!1,withPenalty:r})},children:"Start"})]}),Object(j.jsx)(u,{onClick:function(){t.startGame({infMode:!0,withPenalty:r})},children:"Start Inf Mode"})]})]})]})]})})})),y=Object(l.a)((function(e){var t=e.store;return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(o.a,{children:Object(j.jsxs)(s.d,{children:[Object(j.jsx)(s.b,{exact:!0,path:"/",children:t.username?Object(j.jsx)(s.a,{to:"/lobby"}):Object(j.jsx)(x,{store:t})}),Object(j.jsx)(s.b,{exact:!0,path:"/lobby/",children:t.username?t.currentRoom?Object(j.jsx)(s.a,{to:"/room/".concat(t.currentRoom)}):Object(j.jsx)(g,{store:t}):Object(j.jsx)(s.a,{to:"/"})}),Object(j.jsx)(s.b,{exact:!0,path:"/room/:id",children:t.username?t.currentRoom?Object(j.jsx)(k,{store:t}):Object(j.jsx)(s.a,{to:"/lobby"}):Object(j.jsx)(s.a,{to:"/"})})]})})})})),N=n(2),R=function(e,t){e.emit("login",t)},C=function(e){e.emit("createRoom")},A=function(e,t){e.emit("joinRoom",t)},F=function(e){e.emit("getRooms")},I=function(e,t){e.emit("startGame",t)},G=function(e,t){e.emit("gameAction",t)},S=function(e){e.emit("leaveRoom")},E=n(43),L=function(){var e=Object(N.l)({});e.username=null,e.id=null,e.gamedata=null,e.currentFigure=null,e.rooms=null,e.currentRoom=null;var t=f((function(e,t){e.gamedata=t}),e),n=f((function(e,t){e.currentFigure=t}),e),c=f((function(e,t,n){e.id=t,e.username=n}),e),a=f((function(e,t){e.rooms=t}),e),r=f((function(e,t){e.currentRoom=t}),e),i={setGamedata:t,setUsername:c,setCurrentFigure:n,setRooms:a,setCurrentRoom:r},o=function(e,t){return e.on("login",(function(e){var n=e.username,c=e.id;t.setUsername(c,n)})),e.on("getRooms",(function(e){var n=e.rooms;t.setRooms(n)})),e.on("join",(function(e){var n=e.roomId;t.setCurrentRoom(n)})),e.on("gamedata",(function(e){var n=e.gamedata;t.setGamedata(n)})),{joinRoom:f(A,e),login:f(R,e),createRoom:f(C,e),getRooms:f(F,e),startGame:f(I,e),gameAction:f(G,e),leaveRoom:f(S,e)}}(Object(E.a)("ws://localhost:9000"),i);return Object.assign(e,o),e}();i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(y,{store:L})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.e8f2ad30.chunk.js.map